// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DEV_DB_URL")
}

model HostingDetails {
  id                      String       @id @unique @default(uuid())
  user                    User?
  hostedTournamentDetails Tournament[]

  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  isDeleted       Boolean         @default(false)
  @@map("hosting_details")
}

model GamingDetails {
  id            String     @id @unique @default(uuid())
  user          User?
  gamingdetails Tournament[] 

  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  isDeleted       Boolean         @default(false)
  @@map("gaming_details")
}

model User {
  id              String          @id @unique @default(uuid())
  touranment      Tournament[]
  name            String
  username        String
  email           String          @unique
  number          String?
  password        String
  otp             String?
  expTime         DateTime?
  hostingDetails  HostingDetails? @relation(fields: [hostingDetailId], references: [id])
  hostingDetailId String?         @unique
  gamingDetails   GamingDetails?  @relation(fields: [gamingDetailId], references: [id])
  gamingDetailId  String?         @unique

  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  isDeleted       Boolean         @default(false)

  @@map("users")
}

model Tournament {
  id                    String         @id @unique @default(uuid())
  host                  User           @relation(fields: [userId], references: [id])
  hostingDetail         HostingDetails? @relation(fields: [hostedTournamentId], references: [id])
  hostedTournamentId    String?
  gamingDetail          GamingDetails?  @relation(fields: [gamingDetailId], references: [id])
  gamingDetailId        String?
  userId                String
  tournamentName        String
  registrationStartDate DateTime
  registrationEndDate   DateTime
  competitionStartDate  DateTime
  competitionEndDate    DateTime
  description           String

  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
  isDeleted       Boolean         @default(false)
  @@map("tournaments")
}
